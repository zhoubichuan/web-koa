(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{349:function(s,n,a){"use strict";a.r(n);var e=a(9),t=Object(e.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"三-koa-基础知识"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#三-koa-基础知识"}},[s._v("#")]),s._v(" 三.koa 基础知识")]),s._v(" "),n("h2",{attrs:{id:"_1-安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装"}},[s._v("#")]),s._v(" 1.安装")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("npm i koa\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ul",[n("li",[s._v("脚手架")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("npm i koa-generator -g\nkoa2 my-koa\nkoa2 my-koa -e --ejs\ncd my-koa && npm install\nnpm start\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h2",{attrs:{id:"_2-应用程序"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-应用程序"}},[s._v("#")]),s._v(" 2.应用程序")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("const Koa=require('koa')\nconst app= new Koa()\napp.use(async ctx=>{\n    ctx.body=\"hello world\"\n})\napp.on(\"error\",err=>{\n    log.error('server error',err)\n})\napp.listen(3000,()=>{\n    console.log(3000)\n})\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("h2",{attrs:{id:"_3-级联中间件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-级联中间件"}},[s._v("#")]),s._v(" 3.级联中间件")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("const Koa=require('koa')\nconst app=new Koa()\napp.listen(3000,()=>{\n    console.log(3000)\n})\napp.use(async (ctx,next)=>{\n    const start=Date.now()\n    await next()\n    const ms= Date.now()- start;\n    ctx.set('X-Response-Time',`${ms}ms`)\n})\napp.use(async (ctx,next)=>{\n    const start =Date.now()\n    await next()\n    const ms=Date.now() - start;\n    console.log(`${ctx.method} ${ctx.url} - ${ms}`)\n})\napp.use(async ctx=>{\n    ctx.body=\"hello world\"\n})\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br")])]),n("h2",{attrs:{id:"_4-上下文"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-上下文"}},[s._v("#")]),s._v(" 4.上下文")]),s._v(" "),n("h3",{attrs:{id:"koa-context-将-node-的-request-和-response-对象封装到单个对象中-为编写-web-应用程序和-api-提供了许多有用的方法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#koa-context-将-node-的-request-和-response-对象封装到单个对象中-为编写-web-应用程序和-api-提供了许多有用的方法"}},[s._v("#")]),s._v(" Koa Context 将 node 的 request 和 response 对象封装到单个对象中，为编写 web 应用程序和 API 提供了许多有用的方法")]),s._v(" "),n("ul",[n("li",[s._v("ctx.request//这是 koa Request")]),s._v(" "),n("li",[s._v("ctx response //这是 koa Response")]),s._v(" "),n("li",[s._v("ctx.req//原始的 http 请求对象")])]),s._v(" "),n("ul",[n("li",[s._v("ctx.res//原始的 http 响应对象")]),s._v(" "),n("li",[s._v("ctx.app 应用程序实例引用")]),s._v(" "),n("li",[s._v("ctx.request 是 Koa2 中 context 经过封装的请求对象")]),s._v(" "),n("li",[n("code",[s._v("绕过koa的response处理是不被支持的")])])]),s._v(" "),n("h2",{attrs:{id:"_5-获取请求参数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-获取请求参数"}},[s._v("#")]),s._v(" 5.获取请求参数")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("const Koa=require('koa')\nconst app=new Koa()\napp.listen(3000,()=>{\n    console.log(3000)\n})\napp.use(async ctx=>{\n    console.log(ctx.method)//获取请求方法\n    console.log(ctx.url)//获取请求URL\n    console.log(ctx.query)//获取解析的查询字符串\n    consoe.log(ctx.querystirng)//根据?获取原始查询字符串\n    console.log(ctx.headers)//获取请求头对象\n})\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("h2",{attrs:{id:"_6-获取请求体"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-获取请求体"}},[s._v("#")]),s._v(" 6.获取请求体")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("const Koa=require('koa')\nconst querystring=require('querystring')\nconst app= new Koa()\napp.use(async ctx=>{\n    if(ctx.method=='GET'){\n        ctx.set('Content-Type','text/html;charset=utf-8')\n        ctx.body=(\n            `\n            <form method=\"POST\">\n            <input name=\"username\"/>\n            <input type=\"submit\">\n            </form>\n            `\n        )\n    }else if(ctx.method=='POST'){\n        ctx.set('Content-Type','application/json')\n        ctx.body=await parseBody(ctx)\n    }else{\n        ctx.body='Not Allowed'\n    }\n})\nfunction parseBody(ctx){\n    return new Promise(function(resolve,reject){\n        let buffers=[]\n        ctx.req.on(\"data\",data=>{\nctx.req.on(\"data\",data=>{\n    buffers.push(data)\n})\nctx.req.on('end',data=>{\n    let body=buffers.toString()\n    body=querystring.parse(body)\n    resolve(body)\n})\nctx.req.on('error',err=>{\n    reject(err)\n})\n        })\n    })\n}\napp.listen(3000,()=>{\n    console.log(3000)\n})\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br")])]),n("h2",{attrs:{id:"_7-使用中间件获取普通请求体"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-使用中间件获取普通请求体"}},[s._v("#")]),s._v(" 7.使用中间件获取普通请求体")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("npm i koa-bodyparser -S\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("const Koa=require('koa')\nconst querystring=require('querystring')\nconst bodyParser=require('koa-bodyparser')\nconst app=new Koa()\napp.use(bodyParser)\napp.use(async ctx=>{\nif(ctx.method=='GET'){\n    ctx.set('Content-Type','text/html;charset=utf-8')\n    ctx.body=(\n        `\n        <form method=\"POST\">\n            <input name=\"username\"/>\n            <input type=\"submit\"/>\n        </form>\n        `\n    )\n}else if(ctx.method==\"POST\"){\n    ctx.set('Content-Type','application/json')\n}else{\n    ctx.body='Not Allowed'\n}\n})\napp.listen(3000,()=>{\n    console.log(3000)\n})\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br")])]),n("h2",{attrs:{id:"_8-使用中间件获取包含文件的请求体"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-使用中间件获取包含文件的请求体"}},[s._v("#")]),s._v(" 8.使用中间件获取包含文件的请求体")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("npm i koa-better-body -S\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("const Koa=require('koa')\nconst querystring=require('querystring')\nconst path=require('path')\nconst convert=require('koa-convert')\nconst bodyParser=require('koa-better-body')\nconst app=new Koa()\napp.use(convert(bodyParser({\n    uploadDir:path.join(__dirname,'uploads'),\nkeepExtensions:true\n})))\napp.use(async ctx=>{\n    if(ctx.method=='GET'){\n        ctx.set('Content-Type','text/html;charset=utf-8')\n        ctx.body=(\n            `\n            <form method='POST' enctype='multipart/form-data'>\n            <input name='username'/>\n            <input name='vaatar' type='file'/>\n            <input type='submit' />\n            </form>\n            `\n        )\n    }else if(ctx.method=='POST'){\n        ctx.set('Content-Type','application/json')\n        console.log(ctx.request.fields)\n        ctx.body=ctx.request.body\n    }else{\n        ctx.body='Not Allow'\n    }\n})\napp.listen(3000,()=>{\n    console.log(3000)\n})\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br")])]),n("h2",{attrs:{id:"_9-路由中间件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9-路由中间件"}},[s._v("#")]),s._v(" 9.路由中间件")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("npm i koa-router -S\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ul",[n("li",[s._v("单级路由")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("const Koa=require('koa')\nconst Router=require('koa-router')\nconst app=new Koa()\nlet user=new Router()\nuser\n.get('/user',ctx=>{\n    ctx.body='get user'\n})\n.get('/query/:id',ctx=>{\n    ctx.body=ctx.params\n})\n.post('/user',ctx=>{\n    ctx.body='post user'\n})\n.get('/home',ctx=>{\n    ctx.body='get home'\n})\napp.use(user.routes())\napp.listen(3000,()=>{\n    console.log(3000)\n})\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br")])]),n("ul",[n("li",[s._v("多级路由")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("let user=new Router()\nuser.get('/add',ctx=>{\n    ctx.body='get user add'\n})\nlet article=new Router()\narticle.get('/add',ctx=>{\n    ctx.body='get article add'\n})\nlet router=new Router()\nrouter.use('/user',usr.routes())\nrouter.use('/article',article.routes())\napp.use(router.routes())\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("h2",{attrs:{id:"_10-cookie"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_10-cookie"}},[s._v("#")]),s._v(" 10.cookie")]),s._v(" "),n("h3",{attrs:{id:"ctx-cookie-get-name-options-读取上下文请求中的-cookie"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ctx-cookie-get-name-options-读取上下文请求中的-cookie"}},[s._v("#")]),s._v(" ctx.cookie.get(name,[options])读取上下文请求中的 cookie")]),s._v(" "),n("h3",{attrs:{id:"ctx-cookie-set-name-options-在上下文中写入-cookie"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ctx-cookie-set-name-options-在上下文中写入-cookie"}},[s._v("#")]),s._v(" ctx.cookie.set(name,[options])在上下文中写入 cookie")]),s._v(" "),n("ul",[n("li",[s._v("domain:写入 cookie 所在的域名")]),s._v(" "),n("li",[s._v("path：写入 cookie 所在的路径")]),s._v(" "),n("li",[s._v("maxAge：cookie 最大有效时长")]),s._v(" "),n("li",[s._v("expires:cookie 失效时间")]),s._v(" "),n("li",[s._v("httpOnly：是否用 http 请求中获得")]),s._v(" "),n("li",[s._v("overwrite:是否允许重写")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("app.use(async (ctx,next)=>{\n    console.log(ctx.url)\n    if(ctx.url=='/write'){\n        ctx.cookies.set('name','zbc')\n        ctx.body='write'\n    }else{\n        next()\n    }\n})\napp.use(async ctx=>{\n    if(ctx.url=='/read'){\n        ctx.body=ctx.cookies.get('name')\n    }\n})\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("h2",{attrs:{id:"_11-session"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_11-session"}},[s._v("#")]),s._v(" 11.session")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("npm i koa-session -S\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("const Koa =require('koa')\nconst session= require('koa-session')\nconst app=new Koa()\napp.keys=['zbc']\napp.use(session({},app))\napp.use(async ctx=>{\n    let visit=ctx.session.visit\n    if(visit){\n        visit=visit +1\n    }else{\n        visit=1\n    }\n    ctx.session.visit=visit\n    ctx.body=`这是你的第${visit}次访问`\n})\napp.listen(3000,()=>{\n    console.log(3000)\n})\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br")])]),n("h2",{attrs:{id:"_12-模板引擎"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_12-模板引擎"}},[s._v("#")]),s._v(" 12.模板引擎")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("npm i koa-views ejs -S\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("const Koa= require('koa')\nconst views=require('koa-veiws')\nconst path=require('path')\nconst app=new Koa()\napp.use(views(path.join(__dirname,'./views'),{\n    extension:'ejs'\n}))\napp.use(async ctx=>{\n    await ctx.render('index',{name:'zbc'})\n})\napp.listen(3000,()=>{\n    console.log(3000)\n})\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("h2",{attrs:{id:"_13-静态资源中间件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_13-静态资源中间件"}},[s._v("#")]),s._v(" 13.静态资源中间件")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("npm i koa-static -S\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("const Koa =require('koa')\nconst path=require('path')\nconst static=require('koa-static')\nconst app=new Koa()\napp.use(static(path.join(__dirname,'public')))\napp.use(async ctx=>{\n    ctx.body='Not Found'\n})\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])])])}),[],!1,null,null,null);n.default=t.exports}}]);